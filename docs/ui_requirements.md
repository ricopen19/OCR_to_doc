# GUI 要件メモ（現状実装反映 / Tauri + React + Mantine）

確定した入出力仕様（対応拡張子/出力物/ディレクトリ構成）は `docs/spec.md` を参照してください。ここでは UI 側の要件に集中します。  
設定画面に反映する候補（CLI のオプション一覧）は `docs/cli_commands.md` を参照してください。

## 1. 画面一覧（実装）
- ホーム
  - 新規処理導線（「新規処理を開始」）
  - 最近の結果一覧（`result/` を走査して表示）
  - 環境チェック（`dispatcher.py` / `result/` / Python の解決）
- OCR 実行
  - 入力: クリック/ドラッグ＆ドロップで複数選択（現状 UI は `.pdf/.heic/.jpg/.jpeg/.png`）
  - 入力ごとの設定:
    - PDF: 開始/終了ページ
    - PDF/画像: トリミング（CropModal、プレビューは Tauri 環境のみ）
  - オプション: 出力形式（md/docx/xlsx/csv）、Excel出力モード（通常/テーブル）、処理モード（lite/full）、PDF DPI（今回のみ上書き）、画像をPDF化、図表抽出
  - 実行: スタートのみ（キャンセルは未実装）
  - 進捗/ログ: 進捗率、現在メッセージ、残り時間（推定）、ログ末尾
- 結果
  - 生成ファイル一覧（ファイル名のみ）
  - プレビュー: Markdown テキストのみ
  - 操作: 結果フォルダを開く / ファイルを開く / 保存（別名保存）
- 設定
  - `configs/settings.json` に保存（起動時/Run 画面遷移時に再読込）
  - 未保存の変更がある状態で別画面へ移動しようとすると確認モーダルを表示（保存して移動 / 保存せず移動 / キャンセル）
  - ウィンドウサイズ、デフォルト出力形式、画像PDF化/図表抽出、GPU、PDF DPI、チャンクサイズ、休憩設定
  - `outputRoot` は UI 上で保存できるが、現状は処理には反映されない（未接続）

## 2. 状態とエラー
- 状態（UI表示）: `idle` / `running` / `done`（内部的に `error` も扱う）
- 進捗: PDF の `--- Page x/y ---` / `--- Done x/y ---` 等のログから推定し、残り時間（直近ページの移動平均）を表示
- エラー表示: 実行画面は Alert、結果画面は通知/テキストで案内（Tauri 環境外の場合も明示）
- リトライ: 現状は「再実行」導線のみ（失敗ファイルだけの自動再処理は未実装）

## 3. 入力仕様
- ドロップ/選択で複数可（現状、重複検知/警告は未実装）
- 最大ページ数の制限は現状 UI/バックエンドとも未実装（運用で制御）

## 4. 出力仕様
- 形式: Markdown / docx / xlsx（PoC）
- 既定の保存先: CLI（`dispatcher.py`）の仕様に従い、基本は `result/` 配下（詳細は `docs/spec.md`）
- UI での保存: 生成済みファイルを「別名保存」で任意パスにコピーできる

## 5. 配布・同梱（未確定）
- 配布形態: ポータブル zip（app.exe + resources/）
- 同梱: poppler バイナリ（Windows版）。その他モデルは初回DL可にする。
- 容量目標: 100MB 以内。
- 設定: `config.json` をアプリと同階層に置く。
- ログ: `logs/app.log`。PII を避けた簡易テキスト。サイズ上限ローテーション (例 5MB x 3)。

## 6. ナビゲーション構成
- ヘッダー: Burger + タイトル + バージョン表示
- サイドバー: ホーム / 実行 / 結果 / 設定
- フッター: 現状なし

## 7. アクセシビリティ・UX
- キーボード操作: Tab移動、Enterで実行ボタン、Escでモーダル閉じる
- フィードバック: 実行中はボタンを loading、完了/失敗は画面表示と通知でフィードバック
- モバイル幅: 360px でもフォーム/リストが崩れないレイアウト

## 8. 今後のタスク
未完タスクは `docs/Tasks.md` を参照してください（UI 観点の項目も含みます）。
